{"version":3,"sources":["Compass.js"],"names":["cc","Class","extends","Component","properties","Compass_Reset","default","displayName","tooltip","direction4or8","turnUP","type","EventHandler","turnRIGHT","turnDOWN","turnLEFT","turnRIGHT_UP","turnRIGHT_DOWN","turnLEFT_DOWN","turnLEFT_UP","onLoad","Compass","node","Compass_parent","parent","center","getChildByName","opacity","Compass_initial_position","position","controlOFF","Canvas","find","UP","RIGHT_UP","RIGHT","RIGHT_DOWN","DOWN","LEFT_DOWN","LEFT","LEFT_UP","direction_tip_arr","Math_sqrt2","Math","sqrt","on","Node","EventType","TOUCH_START","event","newVec2","convertToNodeSpaceAR","getLocation","TOUCH_MOVE","move_8","move_4","TOUCH_END","v2","Tip_arr","off","TOUCH_CANCEL","start","maxRadius","touchPos","pos","distance","mag","x","y","setPosition","abs","log","i","length"],"mappings":"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","file":"Compass.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\BasicLibrary","sourcesContent":["﻿cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        Compass_Reset: {\r\n            default: true,\r\n            displayName: \"重定位\",\r\n            tooltip: '是否允许罗盘重定位'\r\n        },\r\n        direction4or8: {\r\n            default: true,\r\n            displayName: \"开启8方向\",\r\n            tooltip: '4方向和8方向切换，4方向下，组件目标指向可只设置：上-下-左-右'\r\n        },\r\n        turnUP: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向上组件目标\",\r\n            tooltip: '控制的功能对象目标（上）'\r\n        },\r\n        turnRIGHT: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向右组件目标\",\r\n            tooltip: '控制的功能对象目标（右）'\r\n        },\r\n        turnDOWN: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向下组件目标\",\r\n            tooltip: '控制的功能对象目标（下）'\r\n        },\r\n        turnLEFT: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向左组件目标\",\r\n            tooltip: '控制的功能对象目标（左）'\r\n        },\r\n        turnRIGHT_UP: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向右上组件目标\",\r\n            tooltip: '控制的功能对象目标（右上）'\r\n        },\r\n        turnRIGHT_DOWN: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向右下组件目标\",\r\n            tooltip: '控制的功能对象目标（右下）'\r\n        },\r\n        turnLEFT_DOWN: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向左下组件目标\",\r\n            tooltip: '控制的功能对象目标（左下）'\r\n        },\r\n        turnLEFT_UP: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            displayName: \"向左上组件目标\",\r\n            tooltip: '控制的功能对象目标（左上）'\r\n        }\r\n    },\r\n\r\n    onLoad() {\r\n        this.Compass = this.node;\r\n        this.Compass_parent = this.Compass.parent;\r\n        this.center = this.node.getChildByName('wheel-3');\r\n        if (this.direction4or8) {\r\n            this.node.getChildByName('wheel-1-1').opacity = 255;\r\n            this.node.getChildByName('wheel-1-2').opacity = 0;\r\n        } else {\r\n            this.node.getChildByName('wheel-1-1').opacity = 0;\r\n            this.node.getChildByName('wheel-1-2').opacity = 255;\r\n        };\r\n        this.Compass_initial_position = this.Compass.position;\r\n        this.controlOFF = true;\r\n        this.Canvas = cc.find('Canvas');\r\n        this.UP = this.node.getChildByName('UP');\r\n        this.RIGHT_UP = this.node.getChildByName('RIGHT_UP');\r\n        this.RIGHT = this.node.getChildByName('RIGHT');\r\n        this.RIGHT_DOWN = this.node.getChildByName('RIGHT_DOWN');\r\n        this.DOWN = this.node.getChildByName('DOWN');\r\n        this.LEFT_DOWN = this.node.getChildByName('LEFT_DOWN');\r\n        this.LEFT = this.node.getChildByName('LEFT');\r\n        this.LEFT_UP = this.node.getChildByName('LEFT_UP');\r\n        this.direction_tip_arr = [this.UP, this.RIGHT_UP, this.RIGHT, this.RIGHT_DOWN, this.DOWN, this.LEFT_DOWN, this.LEFT, this.LEFT_UP];\r\n        this.Math_sqrt2 = Math.sqrt(2);\r\n        if (this.Compass_Reset) {\r\n            this.Canvas.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n                let newVec2 = this.Compass_parent.convertToNodeSpaceAR(event.getLocation());\r\n                this.Compass.position = newVec2;\r\n                if (this.direction4or8) {\r\n                    this.Canvas.on(cc.Node.EventType.TOUCH_MOVE, this.move_8, this);\r\n                } else {\r\n                    this.Canvas.on(cc.Node.EventType.TOUCH_MOVE, this.move_4, this);\r\n                }\r\n            }, this);\r\n            this.Canvas.on(cc.Node.EventType.TOUCH_END, function () {\r\n                this.Compass.position = this.Compass_initial_position;\r\n                this.center.position = cc.v2(0, 0);\r\n                this.Tip_arr();\r\n                if (this.direction4or8) {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_8, this);\r\n                } else {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_4, this);\r\n                }\r\n            }, this);\r\n            this.Canvas.on(cc.Node.EventType.TOUCH_CANCEL, function () {\r\n                this.Compass.position = this.Compass_initial_position;\r\n                this.center.position = cc.v2(0, 0);\r\n                this.Tip_arr();\r\n                if (this.direction4or8) {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_8, this);\r\n                } else {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_4, this);\r\n                }\r\n            }, this);\r\n        } else {\r\n            this.Compass.on(cc.Node.EventType.TOUCH_START, function () {\r\n                if (this.direction4or8) {\r\n                    this.Canvas.on(cc.Node.EventType.TOUCH_MOVE, this.move_8, this);\r\n                } else {\r\n                    this.Canvas.on(cc.Node.EventType.TOUCH_MOVE, this.move_4, this);\r\n                }\r\n            }, this);\r\n            this.Compass.on(cc.Node.EventType.TOUCH_END, function () {\r\n                this.center.position = cc.v2(0, 0);\r\n                this.Tip_arr();\r\n                if (this.direction4or8) {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_8, this);\r\n                } else {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_4, this);\r\n                }\r\n            }, this);\r\n            this.Compass.on(cc.Node.EventType.TOUCH_CANCEL, function () {\r\n                this.center.position = cc.v2(0, 0);\r\n                this.Tip_arr();\r\n                if (this.direction4or8) {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_8, this);\r\n                } else {\r\n                    this.Canvas.off(cc.Node.EventType.TOUCH_MOVE, this.move_4, this);\r\n                }\r\n            }, this);\r\n        }\r\n\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    move_8: function (event) {\r\n        var maxRadius = 100;\r\n        let touchPos = event.getLocation();\r\n        var pos = this.Compass.convertToNodeSpaceAR(touchPos);\r\n        let distance = pos.mag();\r\n        if (distance > maxRadius) {\r\n            pos.x = maxRadius * pos.x / distance;\r\n            pos.y = maxRadius * pos.y / distance;\r\n        };\r\n        if (this.controlOFF) {\r\n            this.center.setPosition(pos);\r\n            if (distance > 40) {\r\n                if (this.center.y > 0 && Math.abs(this.center.x / this.center.y) <= 1 / (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.UP);\r\n                    this.turnUP();\r\n                    cc.log('上');\r\n                }\r\n                if (this.center.x > 0 && this.center.y > 0 && Math.abs(this.center.x / this.center.y) < (1 + this.Math_sqrt2) && Math.abs(this.center.x / this.center.y) >= 1 / (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.RIGHT_UP);\r\n                    this.turnRIGHT_UP();\r\n                    cc.log('右上');\r\n                }\r\n                if (this.center.x > 0 && Math.abs(this.center.x / this.center.y) >= (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.RIGHT);\r\n                    this.turnRIGHT();\r\n                    cc.log('右');\r\n                }\r\n                if (this.center.x > 0 && this.center.y < 0 && Math.abs(this.center.x / this.center.y) < (1 + this.Math_sqrt2) && Math.abs(this.center.x / this.center.y) >= 1 / (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.RIGHT_DOWN);\r\n                    this.turnRIGHT_DOWN();\r\n                    cc.log('右下');\r\n                }\r\n                if (this.center.y < 0 && Math.abs(this.center.x / this.center.y) <= 1 / (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.DOWN);\r\n                    this.turnDOWN();\r\n                    cc.log('下');\r\n                }\r\n                if (this.center.x < 0 && this.center.y < 0 && Math.abs(this.center.x / this.center.y) < (1 + this.Math_sqrt2) && Math.abs(this.center.x / this.center.y) >= 1 / (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.LEFT_DOWN);\r\n                    this.turnLEFT_DOWN();\r\n                    cc.log('左下');\r\n                }\r\n                if (this.center.x < 0 && Math.abs(this.center.x / this.center.y) >= (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.LEFT);\r\n                    this.turnLEFT();\r\n                    cc.log('左');\r\n                }\r\n                if (this.center.x < 0 && this.center.y > 0 && Math.abs(this.center.x / this.center.y) < (1 + this.Math_sqrt2) && Math.abs(this.center.x / this.center.y) >= 1 / (1 + this.Math_sqrt2)) {\r\n                    this.Tip_arr(this.LEFT_UP);\r\n                    this.turnLEFT_UP();\r\n                    cc.log('左上');\r\n                }\r\n            }\r\n        };\r\n    },\r\n    move_4: function (event) {\r\n        var maxRadius = 100;\r\n        let touchPos = event.getLocation();\r\n        var pos = this.Compass.convertToNodeSpaceAR(touchPos);\r\n        let distance = pos.mag();\r\n        if (distance > maxRadius) {\r\n            pos.x = maxRadius * pos.x / distance;\r\n            pos.y = maxRadius * pos.y / distance;\r\n        };\r\n        if (this.controlOFF) {\r\n            this.center.setPosition(pos);\r\n            if (distance > 40) {\r\n                if (this.center.y > 0 && Math.abs(this.center.x / this.center.y) <= 1) {\r\n                    this.Tip_arr(this.UP);\r\n                    this.turnUP();\r\n                    cc.log('上');\r\n                }\r\n                if (this.center.x > 0 && Math.abs(this.center.x / this.center.y) > 1) {\r\n                    this.Tip_arr(this.RIGHT);\r\n                    this.turnRIGHT();\r\n                    cc.log('右');\r\n                }\r\n                if (this.center.y < 0 && Math.abs(this.center.x / this.center.y) <= 1) {\r\n                    this.Tip_arr(this.DOWN);\r\n                    this.turnDOWN();\r\n                    cc.log('下');\r\n                }\r\n                if (this.center.x < 0 && Math.abs(this.center.x / this.center.y) > 1) {\r\n                    this.Tip_arr(this.LEFT);\r\n                    this.turnLEFT();\r\n                    cc.log('左');\r\n                }\r\n            }\r\n        };\r\n    },\r\n    Tip_arr(Node) {\r\n        for (let i = 0; i < this.direction_tip_arr.length; i++) {\r\n            this.direction_tip_arr[i].opacity = 0;\r\n            if (i == this.direction_tip_arr.length - 1 && Node) {\r\n                Node.opacity = 255;\r\n                //cc.log('name:' + Node.name);\r\n            }\r\n        }\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}